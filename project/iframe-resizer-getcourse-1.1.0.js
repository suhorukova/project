/*! iframe-resizer-getcourse | version: 1.1.0 | contact me: Alexander Berezin (telegram: @agent_gosdepa) */
!function(){"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var run=function run($){$(function($){window.parentIFrame&&$.gc&&$.gc.liteForm&&$.gc.liteForm.prototype&&($.gc.liteForm.prototype.sendForm=function(){this.resultBlock.removeClass("error"),this.resultBlock.removeClass("success"),this.resultBlock.hide();var a=this.element,c=!1,b,e,d;$(this.element).find(".required-one-selected").each(function(){for(var e=$(this).val().split(","),t=0;t<e.length;t++)if(a.find(".form-position-offer-"+e[t]+":checked").length)return;c=!0}),c?alert("Должно быть выбрано предложение"):(b=this,e=this.element.attr("action"),d=$(this.element).serialize(),d&&""!=d||(d={}),"object"==_typeof(d)?d.fromUrl=encodeURIComponent(location.href):d=d+"&fromUrl="+encodeURIComponent(location.href),this.breakedOn&&(d=d+"&formParams[breakedOn]="+this.breakedOn),this.dealId&&(d=d+"&formParams[dealId]="+this.dealId),$(this.element).find('input[type="checkbox"].form-position-input').not(":checked").each(function(e,t){d=d+"&formParams[not_selected_offer_id][]="+$(t).val()}),$(this.element).find('input[type="radio"].prolong-offer').not(":checked").each(function(e,t){0!=$(t).attr("data-offer-id")&&(d=d+"&formParams[not_selected_offer_id][]="+$(t).attr("data-offer-id"))}),$(this.element).find('input[type="radio"].prolong-offer:checked').each(function(e,t){0!=$(t).attr("data-offer-id")&&(d=d+"&formParams[offer_id][]="+$(t).attr("data-offer-id"))}),b.buttonSubmit.find(".form-loader").get(0)||(b.buttonSubmit.css("width",b.buttonSubmit.innerWidth()),b.buttonSubmit.prepend('<img class="form-loader" src="/public/img/spinner.png"/>')),this.resultBlock.html(""),b.lastSend&&Date.now()-b.lastSend<4e3&&alert("Запрос еще обрабатывается"),b.lastSend=Date.now(),ajaxCall(e,d,{enableSimpleSign:!0,async:1!=a.data("open-new-window")},function(a){if(b.buttonSubmit.find(".form-loader").remove(),b.lastSend=null,b.breakedOn=a.data.breakedOn,a.data.dealId&&(b.dealId=a.data.dealId),a.data.formProcessed){if(a.data.preParts)for(var key in a.data.preParts){var c=a.data.preParts[key];c.javascript&&eval(c.javascript),c.html&&b.resultBlock.html(c.html)}if(a.data.redirectUrl&&!a.data.noRedirect){if(c=a.data.redirectUrl,a.data.confirmMessage&&a.data.confirmCancelRedirectUrl&&!confirm(a.data.confirmMessage)&&(c=a.data.confirmCancelRedirectUrl),a.data.newWindow)return void(null===window.open(c)&&(window.location.href=c));if(window.location.href=c,!a.data.refreshPage)return}if(a.data.refreshPage)window.location.reload();else{for(var key in b.resultBlock.html("<h3 class='text-center'>"+a.data.defaultMessage+"</h3>"),a.data.parts)c=a.data.parts[key],c.html&&b.resultBlock.html(c.html);b.element.height(b.element.height()),b.resultBlock.show(),b.formContentBlock.hide()}}else b.resultBlock.show(),b.resultBlock.html("<div class='error-message'>"+a.data.error+"</div>"),b.resultBlock.addClass("error"),b.resultBlock.parent().find("button").each(function(){var e=$(this).attr("id");window["prs"+e]=!1,$(this).removeClass("disabled")})},function(){b.formContentBlock.trigger("submitForm")}))})});var resetIFrameHeight=function(){setTimeout(function(){parentIFrame.autoResize(!1),parentIFrame.size(100),parentIFrame.autoResize(!0),parentIFrame.size()},10)},isPaymentPage=-1!==location.href.indexOf("/sales/shop/dealPay/"),CPShown=!1,styles="";styles+="html { overflow: hidden !important; margin: 0 !important }",styles+="html, body { height: auto !important }",styles+="#gcAccountUserMenu, .lt-page-edit-link, .talks-widget-button, .smartbanner { display: none !important }",isPaymentPage&&(styles+=".main-page-block { padding-bottom: 0 !important }",styles+=".page-header { margin-top: 0 !important }",styles+=".logo, .gc-tasks-block, .global-controls { display: none !important }",styles+='html[data-abm-cp-lock="true"] { min-height: 700px !important; position: static !important }',styles+='html[data-abm-cp-lock="true"] body { margin: 0 !important; padding: 0 !important; position: static !important }',styles+='html[data-abm-cp-lock="true"] body > * { display: none !important }',styles+='html[data-abm-cp-lock="true"] [id^="cp-scrollable"] { display: block !important }'),$("<style></style>").text(styles).appendTo($("body")),isPaymentPage&&$(function(){$(".xdget-payform form").attr("target","_blank"),$(".xdget-customPayformMethods").next().filter('.xdget-common-container.div[style*="height: 150px"]').hide();function e(){var e=$('[id^="cp-scrollable"]');CPShown=e.length?(CPShown||($("html").attr("data-abm-cp-lock","true"),resetIFrameHeight(),parentIFrame.scrollToOffset(0,0)),!0):(CPShown&&($("html").attr("data-abm-cp-lock","false"),resetIFrameHeight()),!1)}e(),setInterval(e,100)}),parentIFrame.size(),setTimeout(function(){parentIFrame.size()},100),setTimeout(function(){parentIFrame.size()},500),setTimeout(function(){parentIFrame.size()},1e3)},jQueryWait=function e(){window.jQuery?run(window.jQuery):setTimeout(e,10)};function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}window.iFrameResizer={onReady:function(){jQueryWait()}};var iframeResizer_contentWindow=createCommonjsModule(function(Ce){!function(d){if("undefined"!=typeof window){var o=!0,i=10,r="",a=0,s="",c=null,l="",u=!1,m={resize:1,click:1},f=128,h=!0,p=1,n="bodyOffset",g=n,y=!0,b="",v={},w=32,T=null,S=!1,k="[iFrameSizer]",I=k.length,O="",E={max:1,min:1,bodyScroll:1,documentElementScroll:1},M="child",C=window.parent,P="*",x=0,N=!1,e=null,z=16,F=1,t="scroll",R=t,$=window,A=function(){ie("onMessage function not defined")},B=function(){},j=function(){},L={height:function(){return ie("Custom height calculation function not defined"),document.documentElement.offsetHeight},width:function(){return ie("Custom width calculation function not defined"),document.body.scrollWidth}},U={},_=!1;try{var W=Object.create({},{passive:{get:function(){_=!0}}});window.addEventListener("test",Z,W),window.removeEventListener("test",Z,W)}catch(e){}var D,H,q,Q,J,V,K=Date.now||function(){return(new Date).getTime()},X={bodyOffset:function(){return document.body.offsetHeight+pe("marginTop")+pe("marginBottom")},offset:function(){return X.bodyOffset()},bodyScroll:function(){return document.body.scrollHeight},custom:function(){return L.height()},documentElementOffset:function(){return document.documentElement.offsetHeight},documentElementScroll:function(){return document.documentElement.scrollHeight},max:function(){return Math.max.apply(null,ye(X))},min:function(){return Math.min.apply(null,ye(X))},grow:function(){return X.max()},lowestElement:function(){return Math.max(X.bodyOffset()||X.documentElementOffset(),ge("bottom",ve()))},taggedElement:function(){return be("bottom","data-iframe-height")}},Y={bodyScroll:function(){return document.body.scrollWidth},bodyOffset:function(){return document.body.offsetWidth},custom:function(){return L.width()},documentElementScroll:function(){return document.documentElement.scrollWidth},documentElementOffset:function(){return document.documentElement.offsetWidth},scroll:function(){return Math.max(Y.bodyScroll(),Y.documentElementScroll())},max:function(){return Math.max.apply(null,ye(Y))},min:function(){return Math.min.apply(null,ye(Y))},rightMostElement:function(){return ge("right",ve())},taggedElement:function(){return be("right","data-iframe-width")}},G=(D=we,J=null,V=0,function(){var e=K(),t=z-(e-(V=V||e));return H=this,q=arguments,t<=0||z<t?(J&&(clearTimeout(J),J=null),V=e,Q=D.apply(H,q),J||(H=q=null)):J=J||setTimeout(Te,t),Q});ee(window,"message",function(t){var n={init:function(){b=t.data,C=t.source,re(),h=!1,setTimeout(function(){y=!1},f)},reset:function(){y?oe("Page reset ignored by init"):(oe("Page size reset by host page"),Ie("resetPage"))},resize:function(){Se("resizeParent","Parent window requested size check")},moveToAnchor:function(){v.findTarget(i())},inPageLink:function(){this.moveToAnchor()},pageInfo:function(){var e=i();oe("PageInfoFromParent called from parent: "+e),j(JSON.parse(e)),oe(" --")},message:function(){var e=i();oe("onMessage called from parent: "+e),A(JSON.parse(e)),oe(" --")}};function o(){return t.data.split("]")[1].split(":")[0]}function i(){return t.data.substr(t.data.indexOf(":")+1)}function r(){return t.data.split(":")[2]in{true:1,false:1}}function e(){var e=o();e in n?n[e]():!Ce.exports&&"iFrameResize"in window||"jQuery"in window&&"iFrameResize"in window.jQuery.prototype||r()||ie("Unexpected message ("+t.data+")")}k===(""+t.data).substr(0,I)&&(!1===h?e():r()?n.init():oe('Ignored message of type "'+o()+'". Received before initialization.'))}),ee(window,"readystatechange",Me),Me()}function Z(){}function ee(e,t,n,o){e.addEventListener(t,n,!!_&&(o||{}))}function te(e){return e.charAt(0).toUpperCase()+e.slice(1)}function ne(e){return k+"["+O+"] "+e}function oe(e){S&&"object"===_typeof(window.console)&&console.log(ne(e))}function ie(e){"object"===_typeof(window.console)&&console.warn(ne(e))}function re(){function e(e){return"true"===e}var t,n;t=b.substr(I).split(":"),O=t[0],a=d!==t[1]?Number(t[1]):a,u=d!==t[2]?e(t[2]):u,S=d!==t[3]?e(t[3]):S,w=d!==t[4]?Number(t[4]):w,o=d!==t[6]?e(t[6]):o,s=t[7],g=d!==t[8]?t[8]:g,r=t[9],l=t[10],x=d!==t[11]?Number(t[11]):x,v.enable=d!==t[12]&&e(t[12]),M=d!==t[13]?t[13]:M,R=d!==t[14]?t[14]:R,oe("Initialising iFrame ("+location.href+")"),function(){function e(e,t){return"function"==typeof e&&(oe("Setup custom "+t+"CalcMethod"),L[t]=e,e="custom"),e}"iFrameResizer"in window&&Object===window.iFrameResizer.constructor&&(function(){var e=window.iFrameResizer;oe("Reading data from page: "+JSON.stringify(e)),Object.keys(e).forEach(ae,e),A="onMessage"in e?e.onMessage:A,B="onReady"in e?e.onReady:B,P="targetOrigin"in e?e.targetOrigin:P,g="heightCalculationMethod"in e?e.heightCalculationMethod:g,R="widthCalculationMethod"in e?e.widthCalculationMethod:R}(),g=e(g,"height"),R=e(R,"width"));oe("TargetOrigin for parent set to: "+P)}(),function(){d===s&&(s=a+"px");se("margin",function(e,t){-1!==t.indexOf("-")&&(ie("Negative CSS value ignored for "+e),t="");return t}("margin",s))}(),se("background",r),se("padding",l),(n=document.createElement("div")).style.clear="both",n.style.display="block",n.style.height="0",document.body.appendChild(n),ue(),me(),document.documentElement.style.height="",document.body.style.height="",oe('HTML & body height set to "auto"'),oe("Enable public methods"),$.parentIFrame={autoResize:function(e){return!0===e&&!1===o?(o=!0,fe()):!1===e&&!0===o&&(o=!1,le("remove"),null!==c&&c.disconnect(),clearInterval(T)),Ee(0,0,"autoResize",JSON.stringify(o)),o},close:function(){Ee(0,0,"close")},getId:function(){return O},getPageInfo:function(e){"function"==typeof e?(j=e,Ee(0,0,"pageInfo")):(j=function(){},Ee(0,0,"pageInfoStop"))},moveToAnchor:function(e){v.findTarget(e)},reset:function(){Oe("parentIFrame.reset")},scrollTo:function(e,t){Ee(t,e,"scrollTo")},scrollToOffset:function(e,t){Ee(t,e,"scrollToOffset")},sendMessage:function(e,t){Ee(0,0,"message",JSON.stringify(e),t)},setHeightCalculationMethod:function(e){g=e,ue()},setWidthCalculationMethod:function(e){R=e,me()},setTargetOrigin:function(e){oe("Set targetOrigin: "+e),P=e},size:function(e,t){Se("size","parentIFrame.size("+((e||"")+(t?","+t:""))+")",e,t)}},fe(),v=function(){function r(e){var t=e.getBoundingClientRect(),n={x:window.pageXOffset!==d?window.pageXOffset:document.documentElement.scrollLeft,y:window.pageYOffset!==d?window.pageYOffset:document.documentElement.scrollTop};return{x:parseInt(t.left,10)+parseInt(n.x,10),y:parseInt(t.top,10)+parseInt(n.y,10)}}function t(e){var t,n=e.split("#")[1]||e,o=decodeURIComponent(n),i=document.getElementById(o)||document.getElementsByName(o)[0];d!==i?(t=r(i),oe("Moving to in page link (#"+n+") at x: "+t.x+" y: "+t.y),Ee(t.y,t.x,"scrollToOffset")):(oe("In page link (#"+n+") not found in iFrame, so sending to parent"),Ee(0,0,"inPageLink","#"+n))}function e(){""!==location.hash&&"#"!==location.hash&&t(location.href)}function n(){Array.prototype.forEach.call(document.querySelectorAll('a[href^="#"]'),function(e){"#"!==e.getAttribute("href")&&ee(e,"click",function(e){e.preventDefault(),t(this.getAttribute("href"))})})}v.enable?Array.prototype.forEach&&document.querySelectorAll?(oe("Setting up location.hash handlers"),n(),ee(window,"hashchange",e),setTimeout(e,f)):ie("In page linking not fully supported in this browser! (See README.md for IE8 workaround)"):oe("In page linking not enabled");return{findTarget:t}}(),Se("init","Init message from host page"),B()}function ae(e){var t,n=e.split("Callback");2===n.length&&(this[t="on"+n[0].charAt(0).toUpperCase()+n[0].slice(1)]=this[e],delete this[e],ie("Deprecated: '"+e+"' has been renamed '"+t+"'. The old method will be removed in the next major version."))}function se(e,t){d!==t&&""!==t&&"null"!==t&&oe("Body "+e+' set to "'+(document.body.style[e]=t)+'"')}function ce(n){var e={add:function(e){function t(){Se(n.eventName,n.eventType)}U[e]=t,ee(window,e,t,{passive:!0})},remove:function(e){var t,n,o,i=U[e];delete U[e],t=window,n=e,o=i,t.removeEventListener(n,o,!1)}};if(n.eventNames&&Array.prototype.map){n.eventName=n.eventNames[0];for(var t=n.eventNames,o=e[n.method],i=[],r=0;r<t.length;r++)i.push(o(t[r],r,t))}else e[n.method](n.eventName);oe(te(n.method)+" event listener: "+n.eventType)}function le(e){ce({method:e,eventType:"Animation Start",eventNames:["animationstart","webkitAnimationStart"]}),ce({method:e,eventType:"Animation Iteration",eventNames:["animationiteration","webkitAnimationIteration"]}),ce({method:e,eventType:"Animation End",eventNames:["animationend","webkitAnimationEnd"]}),ce({method:e,eventType:"Input",eventName:"input"}),ce({method:e,eventType:"Mouse Up",eventName:"mouseup"}),ce({method:e,eventType:"Mouse Down",eventName:"mousedown"}),ce({method:e,eventType:"Orientation Change",eventName:"orientationchange"}),ce({method:e,eventType:"Print",eventName:["afterprint","beforeprint"]}),ce({method:e,eventType:"Ready State Change",eventName:"readystatechange"}),ce({method:e,eventType:"Touch Start",eventName:"touchstart"}),ce({method:e,eventType:"Touch End",eventName:"touchend"}),ce({method:e,eventType:"Touch Cancel",eventName:"touchcancel"}),ce({method:e,eventType:"Transition Start",eventNames:["transitionstart","webkitTransitionStart","MSTransitionStart","oTransitionStart","otransitionstart"]}),ce({method:e,eventType:"Transition Iteration",eventNames:["transitioniteration","webkitTransitionIteration","MSTransitionIteration","oTransitionIteration","otransitioniteration"]}),ce({method:e,eventType:"Transition End",eventNames:["transitionend","webkitTransitionEnd","MSTransitionEnd","oTransitionEnd","otransitionend"]}),"child"===M&&ce({method:e,eventType:"IFrame Resized",eventName:"resize"})}function de(e,t,n,o){return t!==e&&(e in n||(ie(e+" is not a valid option for "+o+"CalculationMethod."),e=t),oe(o+' calculation method set to "'+e+'"')),e}function ue(){g=de(g,n,X,"height")}function me(){R=de(R,t,Y,"width")}function fe(){var e;!0===o?(le("add"),e=w<0,window.MutationObserver||window.WebKitMutationObserver?e?he():c=function(){function i(e){function t(e){!1===e.complete&&(oe("Attach listeners to "+e.src),e.addEventListener("load",n,!1),e.addEventListener("error",r,!1),s.push(e))}"attributes"===e.type&&"src"===e.attributeName?t(e.target):"childList"===e.type&&Array.prototype.forEach.call(e.target.querySelectorAll("img"),t)}function o(e){var t;oe("Remove listeners from "+e.src),e.removeEventListener("load",n,!1),e.removeEventListener("error",r,!1),t=e,s.splice(s.indexOf(t),1)}function t(e,t,n){o(e.target),Se(t,n+": "+e.target.src,d,d)}function n(e){t(e,"imageLoad","Image loaded")}function r(e){t(e,"imageLoadFailed","Image load failed")}function a(e){Se("mutationObserver","mutationObserver: "+e[0].target+" "+e[0].type);for(var t=e,n=i,o=0;o<t.length;o++)n(t[o])}var s=[],c=window.MutationObserver||window.WebKitMutationObserver,l=function(){var e=document.querySelector("body");return l=new c(a),oe("Create body MutationObserver"),l.observe(e,{attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0}),l}();return{disconnect:function(){if("disconnect"in l){oe("Disconnect body MutationObserver"),l.disconnect();for(var e=s,t=o,n=0;n<e.length;n++)t(e[n],n,e)}}}}():(oe("MutationObserver not supported in this browser!"),he())):oe("Auto Resize disabled")}function he(){0!==w&&(oe("setInterval: "+w+"ms"),T=setInterval(function(){Se("interval","setInterval: "+w)},Math.abs(w)))}function pe(e,t){var n=0;return t=t||document.body,n=null!==(n=document.defaultView.getComputedStyle(t,null))?n[e]:0,parseInt(n,i)}function ge(e,t){for(var n,o=t.length,i=0,r=0,a=te(e),s=K(),c=0;c<o;c++)r<(i=t[c].getBoundingClientRect()[e]+pe("margin"+a,t[c]))&&(r=i);return s=K()-s,oe("Parsed "+o+" HTML elements"),oe("Element position calculated in "+s+"ms"),z/2<(n=s)&&oe("Event throttle increased to "+(z=2*n)+"ms"),r}function ye(e){return[e.bodyOffset(),e.bodyScroll(),e.documentElementOffset(),e.documentElementScroll()]}function be(e,t){var n=document.querySelectorAll("["+t+"]");return 0===n.length&&(ie("No tagged elements ("+t+") found on page"),document.querySelectorAll("body *")),ge(e,n)}function ve(){return document.querySelectorAll("body *")}function we(e,t,n,o){var i,r;function a(e,t){return!(Math.abs(e-t)<=x)}i=d!==n?n:X[g](),r=d!==o?o:Y[R](),a(p,i)||u&&a(F,r)||"init"===e?(ke(),Ee(p=i,F=r,e)):e in{init:1,interval:1,size:1}||!(g in E||u&&R in E)?e in{interval:1}||oe("No change in size detected"):Oe(t)}function Te(){V=K(),J=null,Q=D.apply(H,q),J||(H=q=null)}function Se(e,t,n,o){N&&e in m?oe("Trigger event cancelled: "+e):(e in{reset:1,resetPage:1,init:1}||oe("Trigger event: "+t),("init"===e?we:G)(e,t,n,o))}function ke(){N||(N=!0,oe("Trigger event lock on")),clearTimeout(e),e=setTimeout(function(){N=!1,oe("Trigger event lock off"),oe("--")},f)}function Ie(e){p=X[g](),F=Y[R](),Ee(p,F,e)}function Oe(e){var t=g;g=n,oe("Reset trigger event: "+e),ke(),Ie("reset"),g=t}function Ee(e,t,n,o,i){var r;d===i?i=P:oe("Message targetOrigin: "+i),oe("Sending message to host page ("+(r=O+":"+(e+":"+t)+":"+n+(d!==o?":"+o:""))+")"),C.postMessage(k+r,i)}function Me(){"loading"!==document.readyState&&window.parent.postMessage("[iFrameResizerChild]Ready","*")}}()})}();
