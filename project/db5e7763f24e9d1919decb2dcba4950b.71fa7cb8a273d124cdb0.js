(self.webpackChunkvk=self.webpackChunkvk||[]).push([[34240],{189390:(e,t,o)=>{"use strict";o.d(t,{VideoUploadService:()=>C});var n=Object.defineProperty,i=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,s=(e,t,o)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,l=(e,t)=>{for(var o in t||(t={}))a.call(t,o)&&s(e,o,t[o]);if(i)for(var o of i(t))r.call(t,o)&&s(e,o,t[o]);return e},d=(e,t,o)=>new Promise(((n,i)=>{var a=e=>{try{s(o.next(e))}catch(e){i(e)}},r=e=>{try{s(o.throw(e))}catch(e){i(e)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(a,r);s((o=o.apply(e,t)).next())})),u=1048576;function p(){}function c(e){return new Promise(((t,o)=>{let n=Math.floor(e.size/2)-u/2,i=new Blob([e.slice(0,u),e.slice(n,n+u),e.slice(e.size-u,e.size)]),a=new FileReader;a.onload=function(e){t(function(e){let t=65535,o=65535,n=e.length,i=0;for(;n;){let a=n>359?359:n;n-=a;do{o+=t+=e[i++]}while(--a);t=((65535&t)>>>0)+(t>>>16),o=((65535&o)>>>0)+(o>>>16)}return t=((65535&t)>>>0)+(t>>>16),o=((65535&o)>>>0)+(o>>>16),((o<<16>>>0|t)>>>0).toString(16)}(new Uint8Array(e.target.result)))},a.onerror=()=>{o(new Error("Could not read binary data"))},a.readAsArrayBuffer(i)}))}function h(e,t){return["upload",e,t].join("_")}function f(e){return e.split("?").pop().split("&").map((e=>e.split("="))).findIndex((e=>"expires"===e[0]&&+e[1]>Date.now()))>-1}var g={chunkSize:4194304,threadNumber:4,maxRetryNumber:10,debugMode:!1,headers:{},onRestored:p,onPrepared:p,onStart:p,onStop:p,onFail:p,onCancel:p,onSuccess:p,onChunkUploadSuccess:p,onChunkUploadError:p,onProgress:()=>{}},m={maxRetryNumber:10,headers:{},fileName:"",fileType:"",fileSize:0},v=class{constructor(e,t,o,n){this.failCallback=p,this.offlineCallback=p,this.chunkUploadSuccessCallback=p,this.chunkUploadErrorCallback=p,this.state=0,this.currentRequest=null,this.currentTry=0,this.$uid=v.instanceCount++,this.uploadUrl=e,this.uploadManager=t,this.options=this.normalizeOptions(o),this.logger=n}start(){return 1===this.state||(this.state=1,this.tick()),Promise.resolve()}stop(e=!1){return 0===this.state?Promise.resolve():new Promise((t=>{this.currentRequest&&e?(this.currentRequest.addEventListener("abort",(()=>{this.logger.log(`Thread #${this.$uid}: Halted.`),this.state=0,this.currentRequest=null,t()})),this.currentRequest.abort()):(this.logger.log(`Thread #${this.$uid}: Halted.`),this.state=0,t())}))}onFail(e){this.failCallback=e}onOffline(e){this.offlineCallback=e}onUploadSuccess(e){this.chunkUploadSuccessCallback=e}onUploadError(e){this.chunkUploadErrorCallback=e}tick(){if(1!==this.state)return;this.currentTry=0;let e=this.uploadManager.getNextPayload();e?this.tryLoadChunk(e):this.state=0}tryLoadChunk(e){if(1!==this.state)return;let t=new XMLHttpRequest;this.currentRequest=t,t.open("POST",this.uploadUrl,!0);for(let e in this.options.headers)t.setRequestHeader(e,this.options.headers[e]);t.setRequestHeader("Content-Type",this.options.fileType||"application/octet-stream"),t.setRequestHeader("X-Uploading-Mode","parallel"),t.setRequestHeader("Content-Range",`bytes ${e.startByte}-${e.endByte}/${this.options.fileSize}`),this.options.fileName&&t.setRequestHeader("Content-Disposition","attachment; filename="+encodeURI(this.options.fileName)),t.onload=this.handleLoad.bind(this,e,t),t.onerror=this.handleNetworkError.bind(this,e,t),t.ontimeout=this.handleNetworkError.bind(this,e,t),t.send(e.data)}retryLoadChunk(e,t){setTimeout((()=>{this.currentTry++,this.tryLoadChunk(e)}),t)}handleLoad(e,t){return d(this,null,(function*(){if(this.currentRequest=null,t.status>=200&&t.status<300)this.logger.log(`Thread #${this.$uid}: Chunk ${e.index} (${e.startByte} - ${e.endByte} from ${this.options.fileSize}) uploaded`),this.uploadManager.processChunkUploaderResponse(e,t),this.chunkUploadSuccessCallback(l({},e)),1===this.state&&this.tick();else if(t.status>=300&&t.status<500)this.logger.log(`Thread #${this.$uid}: Failed to upload chunk ${e.index} - Illegal server response`),this.chunkUploadErrorCallback(l({},e),t.status,t.responseText),yield this.stop(),this.failCallback();else{this.chunkUploadErrorCallback(l({},e),t.status,t.responseText);let o=this.options.maxRetryNumber>0,n=this.currentTry>=this.options.maxRetryNumber;o&&n?(this.logger.log(`Thread #${this.$uid}: Failed to upload chunk ${e.index} - Max retry number exceeded (${this.options.maxRetryNumber})`),yield this.stop(),this.failCallback()):(this.logger.log(`Thread #${this.$uid}: Failed to upload chunk ${e.index}. Retrying in 500ms`),this.retryLoadChunk(e,500))}}))}handleNetworkError(e,t){return d(this,null,(function*(){this.chunkUploadErrorCallback(e,t.status,t.responseText),yield this.stop(),this.offlineCallback(this)}))}normalizeOptions(e={}){let t=l({},m);return Number.isInteger(e.maxRetryNumber)&&(t.maxRetryNumber=e.maxRetryNumber),e.headers&&(t.headers=l({},e.headers)),"string"==typeof e.fileName&&(t.fileName=e.fileName),"string"==typeof e.fileType&&(t.fileType=e.fileType),Number.isInteger(e.fileSize)&&(t.fileSize=e.fileSize),t}},b=v;b.instanceCount=0;var _=class{},y=class extends _{constructor(){super(...arguments),this.log=console.log.bind(console),this.warn=console.warn.bind(console),this.error=console.error.bind(console),this.time=console.time.bind(console),this.timeEnd=console.timeEnd.bind(console)}},k=()=>{},U=class extends _{constructor(){super(...arguments),this.log=k,this.warn=k,this.error=k,this.time=k,this.timeEnd=k}},S=class{constructor(e,t,o){this.onRestoredCallback=p,this.onPreparedCallback=p,this.onStartCallback=p,this.onStopCallback=p,this.onFailCallback=p,this.onCancelCallback=p,this.onProgressCallback=p,this.onSuccessCallback=p,this.onChunkUploadSuccessCallback=p,this.onChunkUploadErrorCallback=p,this.state=0,this.key="",this.$uid=S.instanceCount++,this.chunkUploaderPool=[],this.uploadUrlObject=e,this.options=this.normalizeOptions(o),this.logger=class{static createLogger(e){return e?new y:new U}}.createLogger(this.options.debugMode),this.options.onRestored!==p&&this.onRestored(this.options.onRestored),this.options.onPrepared!==p&&this.onPrepared(this.options.onPrepared),this.options.onStart!==p&&this.onStart(this.options.onStart),this.options.onStop!==p&&this.onStop(this.options.onStop),this.options.onCancel!==p&&this.onCancel(this.options.onCancel),this.options.onFail!==p&&this.onFail(this.options.onFail),this.options.onProgress!==p&&this.onProgress(this.options.onProgress),this.options.onSuccess!==p&&this.onSuccess(this.options.onSuccess),this.options.onChunkUploadSuccess!==p&&this.onChunkUploadSuccess(this.options.onChunkUploadSuccess),this.options.onChunkUploadError!==p&&this.onChunkUploadError(this.options.onChunkUploadError),this.dataSource=new class{constructor(e){this.hash="",this.file=e}getChunk(e,t){return this.file.slice(e,t+1)}getName(){return this.file.name}getSize(){return this.file.size}getType(){return this.file.type}getHash(){return d(this,null,(function*(){if(this.hash)return Promise.resolve(this.hash);let e=yield c(this.file);return this.hash=e,e}))}}(t),this.uploadManager=new class{constructor(e,t,o){this.uploadedDataRangesStr="",this.progress=0,this.progressChangeCallback=p,this.dataSource=e,this.chunkSize=t,this.logger=o,this.chunkUploadMap=[];let n=Math.ceil(this.fileSize/this.chunkSize);for(let e=0;e<n;e++)this.chunkUploadMap.push(0)}get fileSize(){return this.dataSource.getSize()}getNextPayload(){let e=this.chunkUploadMap.findIndex((e=>0===e));return-1===e?null:this.getChunkPayload(e)}getLastChunkPayload(){return this.getChunkPayload(this.chunkUploadMap.length-1)}processChunkUploaderResponse(e,t){switch(this.chunkUploadMap[e.index]=2,t.status){case 200:this.uploadedFileObject=JSON.parse(t.response),this.updateProgress();break;case 201:this.uploadedDataRangesStr=t.responseText||t.getResponseHeader("Range")||"",this.setUploadedBytes(this.uploadedDataRangesStr);break;default:this.logger.warn(`Unsupported request status code ${t.status}`)}}getProgress(){return this.progress}getChunkLeftNumber(){return this.chunkUploadMap.filter((e=>0===e)).length}getChunkLoadedNumber(){return this.chunkUploadMap.filter((e=>2===e)).length}getUploadedFileObject(){return this.uploadedFileObject}getUploadedDataRangesStr(){return this.uploadedDataRangesStr}setUploadedBytes(e=""){let t=this.parseStatString(e);this.updateChunkUploadMap(t),this.updateProgress()}onProgressChange(e){this.progressChangeCallback=e}clearUploadingState(){for(let e=0;e<this.chunkUploadMap.length;e++)1===this.chunkUploadMap[e]&&(this.chunkUploadMap[e]=0)}getChunkPayload(e){let t=e*this.chunkSize,o=(e+1)*this.chunkSize-1;o=Math.min(o,this.fileSize-1);let n=this.dataSource.getChunk(t,o);return this.chunkUploadMap[e]=1,{index:e,startByte:t,endByte:o,data:n}}updateChunkUploadMap(e){this.chunkUploadMap=this.chunkUploadMap.map(((t,o)=>1===t?1:e.find((e=>{let t=o*this.chunkSize,n=Math.min((o+1)*this.chunkSize,this.fileSize)-1;return t>=e[0]&&n<=e[1]}))?2:0))}updateProgress(){let e=this.chunkUploadMap.filter((e=>2===e)).length/this.chunkUploadMap.length*100;this.progress!==e&&(this.progress=e,this.progressChangeCallback(this.progress))}parseStatString(e){return e.split(",").map((e=>{let t=e.split("/")[0].split("-");return[parseInt(t[0]),parseInt(t[1])]}))}}(this.dataSource,this.options.chunkSize,this.logger),this.uploadManager.onProgressChange(this.onProgressChangeHandler.bind(this)),this.uploadPromise=new Promise(((e,t)=>{this.uploadResolveHandler=e,this.uploadRejectHandler=t})),this.logger.log("UploadSession: instance created and configured with following options:",this.options)}get timerName(){return`${this.dataSource.getName()} uploaded in`}upload(){return d(this,null,(function*(){return 0===this.state&&(yield this.prepare()),1===this.state&&(yield this.start()),this.uploadPromise}))}start(){return d(this,null,(function*(){switch(0===this.state&&(yield this.prepare()),this.state){case 1:this.logger.log("UploadSession: Starting uploading process"),this.logger.time(this.timerName);break;case 3:this.logger.log("UploadSession: Resuming uploading process");break;default:return this}return this.onProgressCallback(this.uploadManager.getProgress()),this.state=2,yield Promise.all(this.chunkUploaderPool.map((e=>e.start()))),this.onStartCallback(),this}))}stop(e=!1){return d(this,null,(function*(){return 2!==this.state||(yield Promise.all(this.chunkUploaderPool.map((t=>t.stop(e)))),this.state=3,this.uploadManager.clearUploadingState(),this.onStopCallback()),this}))}cancel(){return d(this,null,(function*(){return 4===this.state||5===this.state||6===this.state||(this.logger.log("UploadSession: Cancelling uploading process..."),yield this.stop(!0),this.onCancelCallback(),this.uploadRejectHandler(new Error("Uploading was cancelled"))),this}))}onRestored(e){return this.onRestoredCallback=e,this}onPrepared(e){return this.onPreparedCallback=e,this}onStart(e){return this.onStartCallback=e,this}onStop(e){return this.onStopCallback=e,this}onFail(e){return this.onFailCallback=e,this}onCancel(e){return this.onCancelCallback=e,this}onProgress(e){return this.onProgressCallback=e,this}onSuccess(e){return this.onSuccessCallback=e,this}onChunkUploadSuccess(e){return this.onChunkUploadSuccessCallback=e,this}onChunkUploadError(e){return this.onChunkUploadErrorCallback=e,this}getUploadUrl(){return this.uploadUrl}getChunkLeftNumber(){return this.uploadManager.getChunkLeftNumber()}getChunkLoadedNumber(){return this.uploadManager.getChunkLoadedNumber()}getLoadedRangesStr(){return this.uploadManager.getUploadedDataRangesStr()}prepare(){return d(this,null,(function*(){this.key=yield this.createUploadSessionKey(),this.logger.log("UploadSession: UploadSession calculated key",this.key);let e=function(e){try{let t=localStorage.getItem(e);return t?JSON.parse(t):null}catch(e){return null}}(this.key);e&&f(e.url)?(this.logger.log("UploadSession: Found stored session for this file",e),this.uploadUrl=e.url,this.uploadManager.setUploadedBytes(e.loaded)):(this.uploadUrl=yield this.resolveUploadUrl(this.uploadUrlObject),this.logger.log("UploadSession: Resolved upload url",this.uploadUrl));for(let e=0;e<this.options.threadNumber;e++)this.chunkUploaderPool.push(this.createChunkUploader(this.uploadUrl));this.saveSessionData(),this.state=1,this.onPreparedCallback()}))}resolveUploadUrl(e){switch(typeof e){case"string":return Promise.resolve(e);case"function":return e();default:throw new Error("UploadSession: Unsupported upload url object")}}createUploadSessionKey(){return d(this,null,(function*(){return h(yield this.dataSource.getHash(),this.dataSource.getSize())}))}saveSessionData(){let e={url:this.uploadUrl,loaded:this.uploadManager.getUploadedDataRangesStr()};try{localStorage.setItem(this.key,JSON.stringify(e))}catch(e){this.logger.error("UploadSession: Could not save session data")}}clearSessionData(){try{localStorage.removeItem(this.key)}catch(e){this.logger.error("UploadSession: Could not remove session data")}}createChunkUploader(e){let t={maxRetryNumber:this.options.maxRetryNumber,headers:this.options.headers,fileSize:this.dataSource.getSize(),fileName:this.dataSource.getName(),fileType:this.dataSource.getType()},o=new b(e,this.uploadManager,t,this.logger);return o.onOffline(this.onThreadOfflineHandler.bind(this)),o.onFail(this.onThreadFailedHandler.bind(this)),o.onUploadSuccess(this.onChunkUploadSuccessHandler.bind(this)),o.onUploadError(this.onChunkUploadErrorHandler.bind(this)),o}onThreadOfflineHandler(e){return d(this,null,(function*(){this.logger.warn(`UploadSession: Thread #${e.$uid} went offline: Switching to ping mode...`),yield this.stop(!0),yield this.ping(),this.logger.warn("UploadSession: Connection renewed: Proceed upload process"),yield this.start()}))}onThreadFailedHandler(){return d(this,null,(function*(){yield this.stop(!0),this.onFailCallback(),this.uploadRejectHandler()}))}onChunkUploadErrorHandler(e,t,o){return d(this,null,(function*(){this.onChunkUploadErrorCallback(e,t,o)}))}onChunkUploadSuccessHandler(e){return d(this,null,(function*(){this.onChunkUploadSuccessCallback(e)}))}onProgressChangeHandler(e){if(this.onProgressCallback(e),this.saveSessionData(),100===e){this.logger.timeEnd(this.timerName);let e=this.uploadManager.getUploadedFileObject();this.onSuccessCallback(e),this.uploadResolveHandler(e),this.clearSessionData()}}getUploadedRanges(){return d(this,null,(function*(){return new Promise(((e,t)=>{let o=new XMLHttpRequest;o.open("GET",this.uploadUrl,!0),o.onload=()=>{o.status>=200&&o.status<300?e(o.responseText):t()},o.onerror=t,o.ontimeout=t,o.send(null)}))}))}ping(){return 6===this.state?Promise.reject():new Promise((e=>{this.getUploadedRanges().then((()=>{e()})).catch((()=>{this.retryPing(e)}))}))}retryPing(e){setTimeout((()=>{this.ping().then(e).catch((()=>{this.retryPing(e)}))}),1e4)}normalizeOptions(e={}){let t=l({},g);return Number.isInteger(e.chunkSize)&&(t.chunkSize=e.chunkSize),Number.isInteger(e.threadNumber)&&(t.threadNumber=e.threadNumber),Number.isInteger(e.maxRetryNumber)&&(t.maxRetryNumber=e.maxRetryNumber),e.headers&&(t.headers=l({},e.headers)),"function"==typeof e.onRestored&&(t.onRestored=e.onRestored),"function"==typeof e.onPrepared&&(t.onPrepared=e.onPrepared),"function"==typeof e.onStart&&(t.onStart=e.onStart),"function"==typeof e.onStop&&(t.onStop=e.onStop),"function"==typeof e.onCancel&&(t.onCancel=e.onCancel),"function"==typeof e.onFail&&(t.onFail=e.onFail),"function"==typeof e.onProgress&&(t.onProgress=e.onProgress),"function"==typeof e.onSuccess&&(t.onSuccess=e.onSuccess),"function"==typeof e.onChunkUploadSuccess&&(t.onChunkUploadSuccess=e.onChunkUploadSuccess),"function"==typeof e.onChunkUploadError&&(t.onChunkUploadError=e.onChunkUploadError),t.debugMode=!0===e.debugMode,t}},w=S;w.instanceCount=0;var C=new class{constructor(){this.sessionList=[],window.addEventListener("online",(()=>{this.startAllUploadSessions()})),window.addEventListener("offline",(()=>{this.stopAllUploadSessions(!0)}))}createUploadSession(e,t,o){let n=new w(e,t,o);return this.sessionList.push(n),n}getFileUploadSession(e){return d(this,null,(function*(){let t=h(yield c(e),e.size);return this.sessionList.find((e=>e.key===t))}))}startAllUploadSessions(){return d(this,null,(function*(){yield Promise.all(this.sessionList.map((e=>e.start())))}))}stopAllUploadSessions(e=!1){return d(this,null,(function*(){yield Promise.all(this.sessionList.map((t=>t.stop(e))))}))}getStoredUploadSessionDataList(){try{return Object.keys(localStorage).filter((e=>/^upload_[A-Za-z0-9]+_\d+$/.test(e))).map((e=>JSON.parse(localStorage.getItem(e))))}catch(e){return[]}}clearExpiredUploadSessionsData(){try{Object.keys(localStorage).filter((e=>/^upload_[A-Za-z0-9]+_\d+$/.test(e))).map((e=>{let t=JSON.parse(localStorage.getItem(e));f(t.url)||localStorage.removeItem(t.lsKey)}))}catch(e){}}}},793047:(e,t,o)=>{"use strict";o.d(t,{jsonpManager:()=>C,Upload:()=>x});o(446964),o(940851),o(66108),o(296253),o(535666),o(21466),o(283946),o(59357),o(751876);var n=o(315544),i=o(49535),a=o(654612),r=o(40906),s=o(695724),l=o(171516),d=o(479957),u=o(124041),p=o(635429),c=o(726271),h=o(520820),f=o(786067),g=o(26330),m=o(668040),v=o(486125),b=o(787481),_=o(676821),y=o(189390),k=o(306908);function U(e,t,o,n,i,a,r){try{var s=e[a](r),l=s.value}catch(e){return void o(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function S(e){return function(){var t=this,o=arguments;return new Promise((function(n,i){var a=e.apply(t,o);function r(e){U(a,n,i,r,s,"next",e)}function s(e){U(a,n,i,r,s,"throw",e)}r(void 0)}))}}var w,C={c:1,h:{},reg:function(e){return C.h[C.c]=(0,r.isFunction)(e)?e:function(){},C.c++}},x={init:function(e,t,o,i){window.uploadInterface=void 0!==window.uploadInterface?window.uploadInterface+1:0;var a=window.uploadInterface;return(0,r.each)(["obj","dropbox","options","vars","types","uploadUrls","callbacks","checks","dragTimer"],(function(e,t){x[t]||(x[t]={})})),this.obj[a]=(0,n.ge)(e),i.dropbox&&(this.dropbox[a]=(0,n.ge)(i.dropbox)),this.vars[a]=o,i.file_input=(0,n.ge)(i.file_input),this.options[a]=i,i.clear&&cur.destroy.push(x.deinit.pbind(a)),this.uploadUrls[a]=t,!i.flash_lite||c.browser.flash||this.checkFileApi()?i.customShowProgress?i.customShowProgress():"INPUT"!==this.obj[a].tagName||this.checkFileApi()?i.flash_lite||(this.obj[a].innerHTML='<div class="upload_check loading">'+(0,p.getProgressHtml)("","pr_medium upload_pr")+"</div>"):this.obj[a]=(0,n.ge)(i.fieldEl)||this.obj[a].parentNode.firstChild:this.obj[a]=(0,n.ge)(i.fieldEl)||this.obj[a].parentNode.firstChild,i.noCheck?this.embed(a):this.check(a),a},deinit:function(e){if(x.obj[e]){var t=(x.options[e]||{}).dragEvObj,o=x.obj[e];if(t&&((0,i.removeEvent)(t,"dragenter"),(0,i.removeEvent)(t,"dragover"),(0,i.removeEvent)(t,"dragleave")),o.innerHTML="",(0,r.each)(["obj","dropbox","options","vars","types","uploadUrls","callbacks"],(function(t,o){x[o]&&delete x[o][e]})),x.callbacks){var n=["oncheck","ondone","onfail"];(0,r.each)(x.flashCallbacks(),(function(e,t){n.push(e)})),(0,r.each)(n,(function(t,o){delete x.callbacks[o+e]}))}clearTimeout(x.checks["timer"+e]),clearTimeout(x.dragTimer[e]),delete x.dragTimer[e]}},check:function(e){var t=this.obj[e],o=this.vars[e],i=this.options[e],a=i.check_url?i.check_url:this.uploadUrls[e],r={};if(i.signed){if(!a)return x.onCheckComplete(e);(0,s.extend)(r,{_jsonp:C.reg((function(t){x.onCheckComplete(e,t)}))})}else{if(!i.check_hash&&!i.server)return x.onCheckComplete(e);if(i.use_go_uploader)return x.onCheckComplete(e);this.callbacks["oncheck"+e]=x.onCheckComplete.pbind(e);var l=["mid","aid","gid","hash","rhash"];for(var d in l)l.hasOwnProperty(d)&&(r[l[d]]=o[l[d]]);i.check_aid&&(r.aid=i.check_aid),i.check_gid&&(r.gid=i.check_gid),i.check_hash&&(r.hash=i.check_hash),i.check_rhash&&(r.rhash=i.check_rhash),o.https_resp&&(r.https_resp=o.https_resp),(0,s.extend)(r,{al:1,act:"check_upload",type:i.type,ondone:"Upload.callbacks.oncheck"+e})}var u='<form action="'+a+'" enctype="multipart/form-data" method="post" id="check_upload_form'+e+'" target="check_iframe'+e+'">';for(var p in r)r.hasOwnProperty(p)&&(u+='<input type="hidden" name="'+p+'" value="'+r[p]+'" />');u+='</form><iframe style="visibility: hidden; width: 1px; height: 1px;" id="check_iframe'+e+'" name="check_iframe'+e+'"></iframe>';var c=(0,n.ce)("div",{id:"check_upload_"+e,innerHTML:u,className:i.checkClass||""},{display:"none"});(0,n.ge)("check_upload_"+e)&&(0,n.re)("check_upload_"+e),t.appendChild(c);var h=(0,n.ge)("check_upload_form"+e);if(h)try{h&&h.submit(),clearTimeout(x.checks["timer"+e]),this.checks["timer"+e]=setTimeout(x.serverFail.pbind(e),1e4)}catch(e){(0,b.debugLog)(e)}},onCheckComplete:function(e,t){clearTimeout(x.checks["timer"+e]),delete x.checks["timer"+e];var o={},n=x.options[e],i=t;if(n.signed)o=(0,h.parseJSON)(t||"{}");else{for(var a in t=(t=t||"").split("&"))if(t.hasOwnProperty(a)){var r=t[a].split("=");o[r[0]]=r[1]}i=o}n.customHideProgress&&n.customHideProgress(),o.error||o.fail?x.serverFail(e,i):(n.noCheck=1,n.onCheckComplete?n.onCheckComplete(e):n.flash_lite&&c.browser.flash?x.initFlash(e,x.obj[e]):x.embed(e),x.serverSuccess(e,i))},serverFail:function(e,t){var o=x.obj[e],n=x.options[e],i=x.vars[e];if(o&&(n.signed||n.server))if(x.fails||(x.fails={}),x.fails[e]=x.fails[e]?x.fails[e]+1:1,n.signed){var r=x.uploadUrls[e].split("?"),l=(0,m.fromQueryString)(r[1]),d=(0,s.extend)({act:"check_result",_resign:l._query||r[1]},t?{_query:t}:{_check:n.check_url.split("?")[1]});window.ajax.post("upload_fails.php",d,{onDone:function(t,i,r,l){x.fails[e]<n.max_attempts?(x.uploadUrls[e]=t,(0,s.extend)(x.options[e],{check_url:i,base_url:r,static_url:l}),x.check(e)):(o.innerHTML="",n.lang&&n.lang.cannot_upload_title&&n.lang.cannot_upload_text&&(0,a.showFastBox)({title:n.lang.cannot_upload_title,width:430,dark:1,bodyStyle:"padding: 20px; line-height: 160%;"},n.lang.cannot_upload_text))}})}else{var u=(0,s.extend)({act:"fail",role:n.type,mid:i.mid,oid:i.oid,gid:i.gid,aid:i.aid,server:n.server,st2_server:n.st2_server,error:n.error,hash:n.error_hash,hash_extra:i.hash_extra},t);n.custom_hash&&(0,s.extend)(u,{custom_hash:n.custom_hash,photo_hash:i.photo_hash,size:i.size,fid:i.fid,vid:i.vid,tag:i.tag}),i.transform_entry&&(0,s.extend)(u,{transform_entry:i.transform_entry,transform_hash:i.transform_hash,security_hash:i.security_hash}),window.ajax.post("upload_fails.php",u,{onDone:function(t,i,r){x.fails[e]<n.max_attempts?(x.uploadUrls[e]=t,(0,s.extend)(x.options[e],r),(0,s.extend)(x.vars[e],i),x.check(e)):(o.innerHTML="",n.lang&&n.lang.cannot_upload_title&&n.lang.cannot_upload_text&&(0,a.showFastBox)({title:n.lang.cannot_upload_title,width:430,dark:1,bodyStyle:"padding: 20px; line-height: 160%;"},n.lang.cannot_upload_text))}})}},serverSuccess:function(e,t){var o=x.options[e],n=x.vars[e];if(x.checked=x.checked||{},x.checked[e]=1,o.signed)window.ajax.post("upload_fails.php",{act:"check_result",_query:t});else if(o.server||o.error_hash){var i=(0,s.extend)({act:"success",mid:n.mid,oid:n.oid,gid:n.gid,aid:n.aid,server:o.server,error:o.error,hash:o.error_hash},t);window.ajax.post("upload_fails.php",i)}},embed:function(e){var t=null!=e.num?e.num:e,o=this.obj[t],i=this.dropbox[t],a=this.options[t];a.noEmbed?(0,n.re)("check_upload_"+e):a.noCheck&&(c.browser.flash>9&&a.forceFlash?this.initFlash(t,o):this.checkFileApi()&&!a.flash_lite?this.initFileApi(t,o,i):c.browser.flash>9&&!a.noFlash?this.initFlash(t,o):a.noForm||this.initForm(t,o))},checkFileApi:function(){return(window.XMLHttpRequest||window.XDomainRequest)&&(window.FormData||window.FileReader&&(window.XMLHttpRequest&&XMLHttpRequest.sendAsBinary||window.ArrayBuffer&&window.Uint8Array&&(window.MozBlobBuilder||window.WebKitBlobBuilder||window.BlobBuilder)))},initFlash:function(e,t){var o=[],i=x.vars[e],a=x.options[e],l={url:a.flashPath||"/swf/uploader_lite.swf",id:"uploader_lite"+e,preventhide:!0,width:"100%",height:c.browser.safari||c.browser.msie||c.browser.chrome&&(0,r.intval)(c.browser.version)<17?a.flashHeight?a.flashHeight+"px":cur.flash_lite&&!(0,n.isVisible)("photos_flash_add_button")?"67px":"25px":"100%"},d={swliveconnect:"true",allowscriptaccess:"always",wmode:c.browser.msie?"opaque":"transparent"};for(var u in x.types[e]="flash",i)i.hasOwnProperty(u)&&o.push(u+"="+i[u]);a.signed||i.ajx||o.push("ajx=1");var p=this.flashCallbacks(),h={};this.callbacks=this.callbacks||{},(0,r.each)(p,(function(t,o){x.callbacks[t+e]=o.pbind(e),h[t]="Upload.callbacks."+t+e}));var f=(0,s.clone)(i);if((0,s.extend)(f,h,{upload_url:x.uploadUrls[e],file_size_limit:a.file_size_limit,file_types_description:a.file_types_description,file_types:a.file_types,file_name:a.file_name,post_data:escape(o.join("&"))}),a.flash_lite?t.innerHTML='<div class="lite_upload" id="lite_upload'+e+'" style="z-index:10000; width: 100%; height: 100%; cursor: pointer;"></div>':(a.lang.button_browse||(a.lang.button_browse="Выбрать файл"),a.flat_button?t.innerHTML='<div id="uploader'+e+'" style="position: relative;"><div id="lite_upload'+e+'" style="position: absolute; height: 100%; width: 100%; z-index: 10000; cursor: pointer;"></div><button class="flat_button button_big button_big_width">'+a.lang.button_browse+"</button></div>":t.innerHTML='<button id="uploader'+e+'" class="flat_button upload_btn '+(a.buttonClass||"")+'" style="position: relative;"><div id="lite_upload'+e+'" style="position: absolute; height: 100%; width: 100%; z-index: 10000; cursor: pointer;"></div>'+a.lang.button_browse+"</button>"),(0,_.renderFlash)((0,n.ge)("lite_upload"+e),l,d,f),c.browser.msie&&(0,n.setStyle)((0,n.ge)("lite_upload"+e),{opacity:0,cursor:"pointer"}),a.lang.switch_mode){var g=a.lang.switch_mode.replace("{link}",'<a onclick="Upload.switchMode('+e+');">');g=g.replace("{/link}","</a>"),t.appendChild((0,n.ce)("div",{innerHTML:g,align:"left",className:"upload_switch_mode"},{marginTop:"15px"}))}},initForm:function(e,t){var o=e,i=this.vars[o],a=this.options[o];this.types[o]="form";var r='<form action="'+this.uploadUrls[o]+'" enctype="multipart/form-data" method="post" id="file_uploader_form'+o+'" target="upload_iframe'+o+'" style="text-align: center; width: 100%;">';if(a.signed)(0,s.extend)(i,{_jsonp:C.reg((function(e){x.onUploadComplete(o,e)}))});else{var l=x.onUploadComplete.pbind(o),d=x.onUploadError.pbind(o);this.callbacks["ondone"+o]=function(){var e=l.pbind.apply(l,arguments);setTimeout((function(){e()}),1)},this.callbacks["onfail"+o]=function(){var e=d.pbind.apply(d,arguments);setTimeout((function(){e()}),1)},(0,s.extend)(i,{al:1,ondone:"Upload.callbacks.ondone"+o,onfail:"Upload.callbacks.onfail"+o})}for(var u in i)i.hasOwnProperty(u)&&(r+='<input type="hidden" name="'+u+'" value="'+i[u]+'" />');var p='<input type="file" class="file" size="28" onchange="'+(a.uploadButton?"Upload.onUploadFileSelected("+o+")":"Upload.onUploadStart("+o+");")+'" name="'+a.file_name+'" style="cursor: pointer;"'+(a.accept?' accept="'+a.accept+'"':"")+'/></form><iframe style="position: absolute; visibility: hidden; width: 1px; height: 1px;" id="upload_iframe'+o+'" name="upload_iframe'+o+'"></iframe>';a.label?r+=a.label.split("{file}").join(p):r+=p,t.innerHTML=r;var c=a.file_input,h=(0,n.geByClass1)("file",t,"input");delete a.file_input,c&&h&&(h.parentNode.replaceChild(c,h),c.onchange=function(){x.onUploadStart(o)},(0,n.data)(c,"changed")&&((0,n.data)(c,"changed",!1),c.onchange())),a.uploadButton&&a.setUploadAction?a.setUploadAction(e,(function(){x.onUploadStart(o)})):a.uploadButton&&!0!==a.uploadButton&&((0,n.ge)(a.uploadButton).onclick=function(){x.onUploadStart(o)})},buttonOver:function(e){var t=x.options[e];t.flash_lite?t.hoverEl?(0,n.addClass)(t.hoverEl,"hover"):(0,n.isVisible)("photos_flash_add_button")?(0,n.addClass)((0,n.ge)("photos_flash_add_button"),"hover"):(0,n.addClass)((0,n.ge)("photos_upload_area"),"hover"):(0,n.addClass)((0,n.ge)("lite_upload"+e).nextSibling,"hover")},buttonOut:function(e){var t=x.options[e];t.flash_lite?t.hoverEl?(0,n.removeClass)(t.hoverEl,"hover"):(0,n.isVisible)("photos_flash_add_button")?((0,n.removeClass)((0,n.ge)("photos_flash_add_button"),"hover"),(0,n.removeClass)((0,n.ge)("photos_flash_add_button"),"active")):(0,n.removeClass)((0,n.ge)("photos_upload_area"),"hover"):((0,n.removeClass)((0,n.ge)("lite_upload"+e).nextSibling,"hover"),(0,n.removeClass)((0,n.ge)("lite_upload"+e).nextSibling,"active"))},buttonDown:function(e){x.options[e].flash_lite?(0,n.isVisible)("photos_flash_add_button")&&(0,n.addClass)((0,n.ge)("photos_flash_add_button"),"active"):(0,n.addClass)((0,n.ge)("lite_upload"+e).nextSibling,"active")},buttonUp:function(e){x.options[e].flash_lite?(0,n.isVisible)("photos_flash_add_button")&&(0,n.removeClass)((0,n.ge)("photos_flash_add_button"),"active"):(0,n.removeClass)((0,n.ge)("lite_upload"+e).nextSibling,"active")},initFileApi:function(e,t,o){var a,r=this.options[e],s=r&&r.dragEl||window.boxLayerWrap;if(o&&s&&(x.addedDocEvent||((0,i.addEvent)(document,"drop",x.drop),x.addedDocEvent=!0),r.dragEvObj=s,(0,i.addEvent)(s,"dragenter",x.dragEnter.pbind(e)),(0,i.addEvent)(s,"dragover",x.dragOver.pbind(e)),(0,i.addEvent)(s,"dragleave",x.dragOut.pbind(e))),this.types[e]="fileApi",r.chooseBox)a='<input class="file" type="file" size="28" onchange="Upload.onFileApiSend('+e+', this.files);"'+(r.multiple?' multiple="true"':"")+(r.accept?' accept="'+r.accept+'"':"")+' name="'+r.file_name+'" style="cursor: pointer;"/>';else if(r.uploadButton)r.lang.button_browse||(r.lang.button_browse="Выбрать файл"),a='<button class="flat_button upload_btn fl_l '+(r.buttonClass||"")+'" onclick="this.nextSibling.nextSibling.click()">'+r.lang.button_browse+'</button><div class="upload_selected fl_l" style="padding: 4px 0 0 10px;"></div><input class="file" type="file" size="28" onchange="geByClass1(\'upload_selected\', this.parentNode).innerHTML = Upload.getFilesNames('+e+", this.files); Upload.onUploadFileSelected("+e+')"'+(r.multiple?' multiple="true"':"")+(r.accept?' accept="'+r.accept+'"':"")+' name="'+r.file_name+'" style="visibility: hidden; position: absolute;"/><br class="clear" />';else if(r.lang.button_browse||(r.lang.button_browse="Выбрать файл"),r.flat_button){var l=u.FlatButton.render({className:"upload_btn"+(r.buttonClass||""),appearance:u.FlatButtonAppearance.PRIMARY,size:u.FlatButtonSize.M,children:r.lang.button_browse,restAttrs:{onclick:"document.querySelector('.flat_button_file').click()"}}),d=`<input class="file flat_button_file" type="file" size="28"\n                     onchange="Upload.onFileApiSend('${e}', this.files);" ${r.multiple?' multiple="true"':""} ${r.accept?' accept="'+r.accept+'"':""} name="${r.file_name}" style="visibility: hidden; position: absolute;"/>\n                `,p=document.createElement("div");p.appendChild(l),p.insertAdjacentHTML("beforeend",d),a=p.innerHTML}else a='<button class="flat_button upload_btn '+(r.buttonClass||"")+'" onclick="this.nextSibling.click()">'+r.lang.button_browse+'</button><input class="file" type="file" size="28" onchange="Upload.onFileApiSend('+e+', this.files);"'+(r.multiple?' multiple="true"':"")+(r.accept?' accept="'+r.accept+'"':"")+' name="'+r.file_name+'" style="visibility: hidden; position: absolute;"/>';r.label&&!r.flat_button?t.innerHTML=r.label.split("{file}").join(a):t.innerHTML=a;var c=r.file_input,h=(0,n.geByClass1)("file",t,"input");c&&h&&(h.parentNode.replaceChild(c,h),c.onchange=function(){x.onFileApiSend(e,this.files)},(0,n.data)(c,"changed")&&((0,n.data)(c,"changed",!1),setTimeout(c.onchange.bind(c),0))),r.uploadButton&&r.setUploadAction?r.setUploadAction(e,(function(){x.onFileApiSend(e,(0,n.geByTag1)("input",t).files)})):r.uploadButton&&!0!==r.uploadButton&&((0,n.ge)(r.uploadButton).onclick=function(){x.onFileApiSend(e,(0,n.geByTag1)("input",t).files)})},switchMode:function(e){x.options[e].noFlash=x.options[e].noCheck=1,x.embed(e)},onUploadFileSelected:function(e){x.options[e].onUploadFileSelected&&x.options[e].onUploadFileSelected()},onUploadStart:function(e,t){cur.fileApiUploadStarted=!0;var o=void 0!==e.ind?e.ind:e;"form"==x.types[o]&&((0,n.ge)("file_uploader_form"+o).submit(),(0,n.geByClass1)("file",x.obj[o]).disabled=!0);var i=x.options[o];i.onUploadStart&&i.onUploadStart(e,t)},getErrorAdditional:function(e){return e.error&&void 0!==e.server&&void 0!==e.bwact?(-1!==e.error.indexOf(":")?",":":")+" from upl_"+(0,r.intval)(e.server)+"?act="+e.bwact.replace(/[^a-zA-Z_0-9]/g,""):""},onUploadComplete:function(e,t,o){var i,a=void 0!==e.ind?e.ind:e,r=x.options[a];(void 0!==o&&a===e&&(e=o),"object"==typeof e&&(e.ind=a),"form"==x.types[a])&&((0,n.geByClass1)("file",x.obj[a]).disabled=!1);if(r.onUploadComplete){var s="";r.signed&&((i=t?(0,h.parseJSON)(t):"")?s=x.getErrorAdditional(i):t='{"error":"ERR_CLIENT_UPLOAD_FAIL: upload request bad result, url \\"'+x.uploadUrls[a]+'\\""}'),r.onUploadComplete(e,t,s)}"form"==x.types[a]&&x.onUploadCompleteAll(e,t),"video"===r.type?(0,d.statlogsValueEvent)("upload_video_fails",1,r.server,"success"):"photo"===r.type?(0,d.statlogsValueEvent)("upload_photo_fails",1,r.server,"success"):"doc"===r.type&&(0,d.statlogsValueEvent)("upload_doc_fails",1,r.server,"success")},onUploadCompleteAll:function(e,t,o){var i=void 0!==e.ind?e.ind:e,a=x.options[i];if(void 0!==o&&i===e&&(e=o),"fileApi"===x.types[i]){var r=(0,n.geByClass1)("file",x.obj[i],"input");r&&(r.value="")}var s={duration:Date.now()-a.uploadStartedTs,type:a.type,total_size:a.filesTotalSize};"subtitles"!==a.type&&this.sendUploadStat(i,s),a.onUploadCompleteAll&&a.onUploadCompleteAll(e,t)},onUploadError:function(e,t){var o=void 0!==e.ind?e.ind:e,i=x.options[o];"form"===x.types[o]&&((0,n.geByClass1)("file",x.obj[o]).disabled=!1);i.signed?i.onUploadComplete&&i.onUploadComplete(e,'{"error":"ERR_CLIENT_UPLOAD_FAIL: upload request fail, code \\"'+t.replace(/([\\\"])/g,"\\$1").replace(/\n/g,"\\n")+'\\", url \\"'+x.uploadUrls[o]+'\\""}'):i.onUploadError&&i.onUploadError(e,t)},onConnectionLost:function(e){var t=void 0!==e.ind?e.ind:e,o=x.options[t];o.onConnectionLost&&o.onConnectionLost(e)},onUploadProgress:function(e,t,o){var n=void 0!==e.ind?e.ind:e,i=x.options[n];i.onUploadProgress&&i.onUploadProgress(e,t,o)},onDebug:function(e,t){var o=void 0!==e.ind?e.ind:e,n=x.options[o];n.onDebug&&n.onDebug(e,t)},onSelectClick:function(e,t){var o=void 0!==e.ind?e.ind:e,n=x.options[o];n.onSelectClick&&n.onSelectClick(e,t)},getFilesNames:function(e,t){if(t&&t.length){var o=this.options[e];return o.multiple?(o.lang.selected_num_files||(o.lang.selected_num_files=["","%s файл","%s файла","%s файлов"]),(0,f.langNumeric)(t.length,o.lang.selected_num_files)):t[0].name.replace(/[&<>"']/g,"")}},checkFileType:function(e,t,o){var n=!1;if(o&&""!==o){var i=!0;if((0,r.each)(o.split(";"),(function(t,o){if(o=o.substr(1).toLowerCase(),e.substr(-o.length).toLowerCase()==o)return i=!1,!1})),!i)return!1}return(0,r.each)(t.split(";"),(function(t,o){if(o=o.substr(1).toLowerCase(),e.substr(-o.length).toLowerCase()==o||".*"==o)return n=!0,!1})),n},checkFilesSizes:function(e,t){var o=this.options[e];if(o.file_size_limit)for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];if(i.size&&i.size>o.file_size_limit){var s=o.lang.filesize_error;return s&&s.indexOf("{count}")>=0&&(s=o.file_size_limit>=1048576?s.replace("{count}",(0,r.intval)(o.file_size_limit/1048576)):s.replace("{count}",(0,r.intval)(o.file_size_limit/1024))),s&&(0,a.showFastBox)({title:(0,f.getLang)("global_error"),width:430,dark:1,bodyStyle:"padding: 20px; line-height: 160%;",onHide:function(){x.embed(e),delete cur.notStarted}},s,(0,f.getLang)("global_cancel")),!1}}return!0},onFileApiSend:function(e,t,o){if(t&&t.length){var n=this.options[e];if(n.file_types){var i=[];if((0,r.each)(t,(function(e,t){x.checkFileType(t.name,n.file_types,n.file_disallowed_types)&&i.push(t)})),!i.length)return void(n.onNoFilteredCallback&&n.onNoFilteredCallback(t));t=i}if((!n.filterCallback||(t=n.filterCallback(e,t)).length)&&(n.reverse_files&&(t=Array.prototype.slice.call(t).reverse()),!n.multiple&&t.length>1&&(t=[t[0]]),this.checkFilesSizes(e,t))){if(n.photoBox&&!o)return x.onPhotoAdd(e,t);if(!n.withoutAutoUpload||o){n.beforeUpload&&n.beforeUpload(e),cur.notStarted=cur.fileApiUploadStarted=!0,n.multi_progress||this.onUploadStart({ind:e,fileName:(t[0].fileName||t[0].name||"").replace(/[&<>"']/g,"")});var s=t.length;if(n.max_files){var l=cur.attachCount;if(!l&&cur.addMedia){var d=-1;for(var u in cur.addMedia)u>d&&(d=u);d>=0&&cur.addMedia[d]&&cur.addMedia[d].attachCount&&(l=cur.addMedia[d].attachCount)}var p=l?l():0,c=(n.max_files_warning||(0,f.getLang)("global_attach_max_n_files",n.max_files)).replace("{count}",n.max_files);n.max_files-p<t.length?(s=n.max_files-p,(0,a.showFastBox)({title:(0,f.getLang)("global_error"),width:430,dark:1,bodyStyle:"padding: 20px; line-height: 160%;",onHide:function(){x.embed(e),delete cur.notStarted,n.onMaxCount&&n.onMaxCount()}},c,(0,f.getLang)("global_continue"),(function(){x.uploadFiles(e,t,s),n.max_files_hide_last?(0,v.curBox)().hide():(0,v.getBoxQueue)().hideAll()}),(0,f.getLang)("global_cancel"))):(n.force_max_files&&(s=Math.min(s,n.max_files-(cur.savedPhotos||[]).length)),this.uploadFiles(e,t,s))}else this.uploadFiles(e,t,s)}else n.onFilesSelected&&n.onFilesSelected(e,t)}}},onPhotoAdd:function(e,t){var o=0,i=0;x.fileList=x.fileList||{},x.fileList[e]||(x.fileList[e]=[],x.options[e].onPhotoBox&&(o=!0)),(0,r.each)(t,(function(t,o){i++;var a=x.options[e].photoBox,r=new RegExp("image.*");o.type.match(r),cur.uploaderPhotoId=(cur.uploaderPhotoId||0)+1;var s=cur.uploaderPhotoId;x.fileList[e][s]=o;var l=(0,n.ce)("img"),d=(0,n.ce)("div",{id:"photos_add_item"+s,className:"photos_add_item",innerHTML:'<span class="photos_add_img photos_add_wait" id="photos_add_cont'+s+'" onmouseover="PhotosAdd.thumbOver('+s+', this);" onmouseout="PhotosAdd.thumbOut('+s+');"><span class="photos_add_s" id="photos_add_s'+s+'">&nbsp;</span></span><span class="bg">&nbsp;</span>'});a.appendChild(d);var u=new FileReader;u.onload=function(e){l.src=e.target.result,l.onload=function(){l.onload=!1;var e,t,o={w:l.width,h:l.height};o.w>130&&(e=130/o.w,o.w=130,o.h=parseInt(o.h*e)),o.h>130&&(t=130/o.h,o.h=130,o.w=parseInt(o.w*t));var i=(0,n.ce)("canvas",{width:o.w,height:o.h});i.getContext("2d").drawImage(l,0,0,o.w,o.h);var a=i.toDataURL("image/jpeg");l.src=a;var r=(0,n.ge)("photos_add_s"+s),d=Math.max(o.w,80),u=Math.min(o.h,98);(0,n.setStyle)(r,{width:d,height:u,marginLeft:Math.ceil((130-d)/2)}),r.innerHTML="",r.appendChild(l),l.onload=function(){setTimeout((function(){r.parentNode.className="photos_add_img"}),0),l.onload=!1},x.finishTask()}},x.taskToQ((function(){u.readAsDataURL(o)}))})),o&&i&&x.options[e].onPhotoBox(),x.options[e].onPhotoAdd&&i&&x.options[e].onPhotoAdd()},uploadPhotos:function(e){var t=[],o=x.fileList[e];for(var n in o)o[n]&&t.push((0,s.extend)(o[n],{fileRef:n}));return x.options[e].onUploadStart&&x.options[e].onUploadStart(),!!t.length&&(cur.uploadCount=Math.min(500,t.length),x.uploadFiles(e,t,cur.uploadCount),!0)},taskToQ:function(e){if(x.previewFileQ||(x.previewFileQ=[]),e&&x.previewFileQ.push(e),!x.doingQ){var t=x.previewFileQ.shift();t&&(x.doingQ=!0,t())}},finishTask:function(){setTimeout((function(){x.doingQ=!1,x.taskToQ()}),100)},uploadFiles:function(e,t,o){if(!(o<=0)){var n,i=this.options[e],a=i.signed?this.vars[e]:(0,s.extend)(this.vars[e],{ajx:1}),r=0,l=0,d=0,u=0,p=[];i.uploading&&(r=i.filesTotalSize||0,l=i.filesTotalCount||0,u=i.filesLoadedCount||0,d=i.filesLoadedSize||0,p=i.filesQueue),i.file_match&&(n=new RegExp(i.file_match,"i"));for(var c=!1,h=0;h<o;h++){var f=(t[h].fileName||t[h].name||"").replace(/[&<>"']/g,"");!i.file_match||f.match(n)?(i.multi_progress&&!i.multi_sequence&&this.onUploadStart({ind:e,fileName:f}),r+=t[h].size,l+=1,p.push(t[h])):c=!0}if(p.reverse(),(0,s.extend)(i,{filesQueue:p,filesTotalSize:r,filesLoadedSize:d,filesLoadedCount:u,filesTotalCount:l,uploadStartedTs:Date.now()}),p.length>0)if(void 0!==cur.multiProgressIndex)cur.nextQueues||(cur.nextQueues=[]),cur.nextQueues.push(e);else{var g=(0,m.toQueryString)(a),v=this.uploadUrls[e]?this.uploadUrls[e]+(this.uploadUrls[e].match(/\?/)?"&":"?")+g:"";i.use_go_uploader&&(v=this.uploadUrls[e]),this.uploadFile(e,p.pop(),v),i.multi_progress&&(cur.multiProgressIndex=e)}else c&&x.onUploadError(e,"file type not supported")}},getFileInfo:function(e,t,o){return t.multi_progress?{ind:e,fileName:o?(o.fileName||o.name||"").replace(/[&<>"']/g,""):"",num:t.filesLoadedCount,totalSize:t.filesTotalSize,loadedSize:t.filesLoadedSize,totalCount:t.filesTotalCount,file:o}:e},supportsChunkedUpload:function(){return!!Blob&&!!(Blob.prototype.webkitSlice||Blob.prototype.mozSlice||Blob.prototype.slice)&&!!FileReader},uploadFileChunkedWithSDK:(w=S(regeneratorRuntime.mark((function e(t,o,n){var i,a,r,l,d,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=x.options[t],a=x.vars[t],r=x.getFileInfo(t,i,o),i.multi_sequence&&(cur.fileApiUploadStarted=!0),l=(1e17*Math.random()).toString(16),d=y.VideoUploadService.createUploadSession(S(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.getUploadDetails(o.size,i,a);case 2:return t=e.sent,e.abrupt("return",t.upload_url);case 4:case"end":return e.stop()}}),e)}))),o,{chunkSize:i.chunkSize||k.VIDEO_UPLOAD_CHUNK_SIZE,threadNumber:k.VIDEO_UPLOAD_FILE_THREAD_NUMBER,maxRetryNumber:k.VIDEO_UPLOAD_CHUNK_MAX_RETRY_NUMBER,debugMode:window.videoUploadSdkConfig&&!0===window.videoUploadSdkConfig.debugMode,headers:{"Session-ID":l},onRestored:e=>{var t=(0,m.fromQueryString)(e.url).vkVideoId;i.onUploadedVideoIdReceived&&i.onUploadedVideoIdReceived(r,t)},onProgress:e=>{(0,s.extend)(r,x.getFileInfo(t,i,o)),x.onUploadProgress(r,e,100)},onChunkUploadError:(e,t,o)=>{window.ajax.post("al_video.php",{act:"uploadVideoFailStat",url:d.getUploadUrl(),error:`${t},${o}`,range:`${e.startByte}-${e.endByte}`,sessionId:l,chunksLeft:d.getChunkLeftNumber(),loaded:d.getLoadedRangesStr()})}}),i.uploadCancelFn=d.cancel.bind(d),d.upload().then((e=>{i.filesLoadedSize+=o.size,i.filesLoadedCount+=1,(0,s.extend)(r,x.getFileInfo(t,i,o)),x.onUploadComplete(r,JSON.stringify(e)),i.filesQueue&&i.filesQueue.length>0?x.uploadFile(t,i.filesQueue.pop()):(x.startNextQueue(t),x.onUploadCompleteAll(r,JSON.stringify(e)),i.uploading=!1)})).catch((e=>{x.onUploadError(r,e)}));case 8:case"end":return e.stop()}}),e)}))),function(e,t,o){return w.apply(this,arguments)}),getUploadDetails:(e,t,o)=>new Promise(((n,i)=>window.ajax.post("al_video.php?act=get_upload_url",{file_size:e,user_agent:window.navigator.userAgent,owner_id:o.oid,tag:o.tag,from:o.from,extra_upload_options:t.extraUploadOptions},{onDone:e=>{n(e)},onFail:e=>{i(e)}}))),uploadFileChunked:function(e,t,o){var n=this.options[e],i=x.getFileInfo(e,n,t);n.multi_sequence&&this.onUploadStart(i);var a={file:t,fileName:(t.name||t.fileName).replace(/[&<>"']/g,""),fileSize:t.size,fileMime:t.type,retryCount:0,timeouts:[],activeRequests:[],requestsProgress:{},pointer:0,isUvUpload:Boolean(this.isUvUpload||n.isUvUpload),state:{url:o,started:Date.now(),loaded:null,chunkSize:n.chunkSize||4194304,sessionId:(1e17*Math.random()).toString(16)}};a.abort=function(e){(0,r.each)(e.timeouts,(function(e,t){clearTimeout(t)})),(0,r.each)(e.activeRequests,(function(e,t){t.abort()})),e.timeouts=[],e.activeRequests=[]}.bind(null,a),a.chunksNum=Math.ceil(a.fileSize/a.state.chunkSize),a.chunksLeft=a.chunksNum;var l=function(e){a.storageKey=["upload",e,a.fileSize].join("_"),n.uploading=!0,n.chunkedUpload=a;var t=g.default.get(a.storageKey);t&&(Date.now()-t.started<864e5?(a.state=t,o=t.url):g.default.remove(a.storageKey));try{console.log("%c Warning: if devtools is logging network requests it may cause high memory usage during file upload","font-size:16px;color:orange;")}catch(e){}p()};if(n.isUvUpload){var d=x.vars[e];window.ajax.post("al_video.php?act=get_upload_url",{file_size:t.size?t.size:0,user_agent:window.navigator.userAgent,owner_id:d.oid,tag:d.tag,from:d.from,extra_upload_options:n.extraUploadOptions},{onDone:function(r){a.state.url=r.upload_url,o=a.state.url,x.uploadUrls[e]=o,u(t,l),n.onUploadedVideoIdReceived&&n.onUploadedVideoIdReceived(i,r.video_id)},onFail:function(){x.terminateUpload(e,t.name)}})}else u(t,l);function u(e,t){var o=1048576,n=Math.floor(e.size/2)-524288,i=[e.slice(0,o),e.slice(n,n+o),e.slice(e.size-o,e.size)];!function e(o){var n=i.shift();if(n){var a=new FileReader;a.addEventListener("loadend",(function(t){var n=new Uint8Array(t.target.result),i=function(){var e=65535,t=65535;return{append:o,result:n};function o(o){for(var n=o.length,i=0;n;){var a=n>359?359:n;n-=a;do{t+=e+=o[i++]}while(--a);e=((65535&e)>>>0)+(e>>>16),t=((65535&t)>>>0)+(t>>>16)}}function n(){return((t=((65535&t)>>>0)+(t>>>16))<<16>>>0|(e=((65535&e)>>>0)+(e>>>16)))>>>0}}();i.append(n),o+=i.result().toString(16),e(o)})),a.readAsArrayBuffer(n)}else t(o)}("")}function p(){for(a.pointer=0,a.chunksLeft=a.chunksNum;a.activeRequests.length<4&&a.pointer<a.fileSize;)c()}function c(){var e=a.pointer,t=Math.min(e+a.state.chunkSize,a.fileSize)-1;if(!(e>=a.fileSize)){var o=!1;a.state.loaded&&(0,r.each)(a.state.loaded.split(","),(function(n,i){var r=i.match(/^(\d+)-(\d+)\/\d+$/),s=parseInt(r[1]),l=parseInt(r[2]);if(e>=s&&t<=l)return o=!0,a.chunksLeft-=Math.ceil((l+1-e)/a.state.chunkSize),a.pointer=l+1,!1})),o?(f(),c()):(h(e,t),a.pointer+=a.state.chunkSize)}}function h(r,l){var d=(t.slice||t.webkitSlice||t.mozSlice).call(t,r,l+1),u=new XMLHttpRequest;u.open("POST",o,!0),u.upload.onprogress=function(e){u.readyState!==XMLHttpRequest.DONE&&(e.lengthComputable&&(a.requestsProgress[r]=e.loaded),f())},u.onload=function(d){var u;a.activeRequests.splice((0,s.indexOf)(a.activeRequests,d.target),1),a.retryCount=0,--a.chunksLeft,201==d.target.status?(a.chunksLeft?(a.state.loaded=d.target.responseText,g.default.set(a.storageKey,a.state),c()):(a.state.loaded=d.target.responseText,g.default.set(a.storageKey,a.state),p()),delete a.requestsProgress[r],f()):200==d.target.status?(g.default.remove(a.storageKey),u=d.target.responseText,(0,s.extend)(i,x.getFileInfo(e,n,t)),x.options[e].filesLoadedSize+=a.fileSize,x.options[e].filesLoadedCount+=1,x.onUploadComplete(i,u),x.options[e].filesQueue&&x.options[e].filesQueue.length>0?x.uploadFile(e,x.options[e].filesQueue.pop(),o):(x.startNextQueue(e),x.onUploadCompleteAll(i,u),n.uploading=!1)):(g.default.remove(a.storageKey),a.abort(),x.onUploadError(i),x.options[e].filesQueue.length||(x.startNextQueue(e),x.onUploadCompleteAll(i,d.target.responseText),n.uploading=!1),m(d.target.status,d.target.responseText,r+"-"+l))},u.onerror=function(e){if(a.activeRequests.splice((0,s.indexOf)(a.activeRequests,e.target),1),++a.retryCount<=50){var t=setTimeout(h.bind(null,r,l),300*a.retryCount);a.timeouts.push(t)}else a.abort(),x.onConnectionLost(i);f(),m(e.target.status,e.target.responseText,r+"-"+l)},a.isUvUpload&&u.setRequestHeader("X-Uploading-Mode","parallel"),u.setRequestHeader("Content-Disposition",'attachment, filename="'+encodeURI(a.fileName)+'"'),u.setRequestHeader("Content-Type",a.fileMime||"application/octet-stream"),u.setRequestHeader("Content-Range","bytes "+r+"-"+l+"/"+a.fileSize),u.setRequestHeader("Session-ID",a.state.sessionId),u.send(d),d=null,a.activeRequests.push(u)}function f(){var o=a.fileSize,l=(a.chunksNum-a.chunksLeft)*a.state.chunkSize;(0,r.each)(a.requestsProgress,(function(e,t){l+=t})),(0,s.extend)(i,x.getFileInfo(e,n,t)),n.multi_progress?x.onUploadProgress(i,l,o):x.onUploadProgress(e,Math.min(l+n.filesLoadedSize,n.filesTotalSize),n.filesTotalSize)}function m(e,t,n){window.ajax.post("al_video.php",{act:"uploadVideoFailStat",url:o,error:e+","+t,range:n,sessionId:a.state.sessionId,chunksLeft:a.chunksLeft,loaded:a.state.loaded})}},resumeUpload:function(e){if(this.options[e].useNewUploader);else{var t=this.options[e].chunkedUpload;x.uploadFileChunked(e,t.file,t.state.url)}},isNeedRequestUrl:function(e){var t=this.options[e];return t.requestOptionsForFile&&"video"===t.type},getUploadOptions:function(e,t){var o=this.options[e],n=cur.gid||0;cur.oid<0&&(0,s.inArray)(cur.module,["public","groups","ads","app"])&&(0,s.inArray)(o.from,["article","post","ads"])&&(n=-cur.oid),x.options[e].uploadOptionsXhr=window.ajax.post("al_video.php?act=get_upload_params",{gid:n,from:o.from},{onDone:function(o){var n=(0,m.toQueryString)(o.vars),i=o.options.url+(o.options.url.match(/\?/)?"&":"?")+n;(0,s.extend)(x.options[e],o.options),(0,s.extend)(x.vars[e],o.vars),x.uploadUrls[e]=i,x.check(e),x.uploadFile(e,t,i,!0)},onFail:function(){x.terminateUpload(e,t.name)}})},uploadFile:function(e,t,o,n){var i=this.options[e];if(!x.isNeedRequestUrl(e)||n)if(i.chunked&&x.supportsChunkedUpload()&&(Boolean(i.isUvUpload)||t.size>i.chunkSize))i.useNewUploader?this.uploadFileChunkedWithSDK(...arguments):x.uploadFileChunked.apply(x,arguments);else{var a=c.browser.msie&&(0,r.intval)(c.browser.version)<10?window.XDomainRequest:window.XMLHttpRequest,d=x.getFileInfo(e,i,t);i.multi_sequence&&this.onUploadStart(d),i.uploading=!0;var u=null;if(window.FormData){var p=new FormData;t instanceof File?p.append(i.file_name,t):p.append(i.file_name,t,t.filename.replace(/[&<>"']/g,"")),u=new a;u.open("POST",o,!0),u.onload=function(n){(0,s.extend)(d,x.getFileInfo(e,i,t)),x.options[e].filesLoadedSize+=t.size,x.options[e].filesLoadedCount+=1,x.onUploadComplete(d,n.target.responseText),x.options[e].filesQueue&&x.options[e].filesQueue.length>0?x.uploadFile(e,x.options[e].filesQueue.pop(),o):(x.startNextQueue(e),x.onUploadCompleteAll(d,n.target.responseText),i.uploading=!1)},u.onerror=function(n){(0,s.extend)(d,x.getFileInfo(e,i,t)),x.options[e].filesTotalSize-=t.size,x.options[e].filesTotalCount-=1,x.onUploadError(d,n.target.responseText),x.options[e].filesQueue.length>0?x.uploadFile(e,x.options[e].filesQueue.pop(),o):(x.startNextQueue(e),x.onUploadCompleteAll(d,n.target.responseText),i.uploading=!1)},u.upload.onprogress=function(o){u.readyState!==XMLHttpRequest.DONE&&(!1,(0,s.extend)(d,x.getFileInfo(e,i,t)),o.lengthComputable&&(i.multi_progress?x.onUploadProgress(d,o.loaded,o.total):x.onUploadProgress(e,Math.min(o.loaded+i.filesLoadedSize,i.filesTotalSize),i.filesTotalSize)))},u.send(p)}else{(0,l.saveStatlogEvents)({name:"upload_tmp_stat",value:1,keys:["window_formdata_not_exists"]});try{if(a&&!a.prototype.sendAsBinary&&window.ArrayBuffer&&window.Uint8Array){var h=window.MozBlobBuilder||window.WebKitBlobBuilder||window.BlobBuilder;h&&(a.prototype.sendAsBinary=function(e){for(var t=new window.ArrayBuffer(e.length),o=new Uint8Array(t,0),n=0;n<e.length;n++)o[n]=255&e.charCodeAt(n);var i=new h;i.append(t);var a=i.getBlob();this.send(a)})}var f=new FileReader;f.onload=function(){(u=new a).onload=function(n){(0,s.extend)(d,x.getFileInfo(e,i,t)),x.options[e].filesLoadedSize+=t.size,x.options[e].filesLoadedCount+=1,x.onUploadComplete(d,n.target.responseText),x.options[e].filesQueue.length>0?x.uploadFile(e,x.options[e].filesQueue.pop(),o):(x.startNextQueue(e),x.onUploadCompleteAll(d,n.target.responseText))},u.onerror=function(n){(0,s.extend)(d,x.getFileInfo(e,i,t)),x.options[e].filesTotalSize-=t.size,x.options[e].filesTotalCount-=1,x.onUploadError(d,n.target.responseText),x.options[e].filesQueue.length>0?x.uploadFile(e,x.options[e].filesQueue.pop(),o):(x.startNextQueue(e),x.onUploadCompleteAll(d,n.target.responseText),i.uploading=!1)},u.upload.onprogress=function(o){(0,s.extend)(d,x.getFileInfo(e,i,t)),o.lengthComputable&&(i.multi_progress?(x.onUploadProgress(d,o.loaded,o.total),i.uploading=!1):x.onUploadProgress(e,Math.min(o.loaded+i.filesLoadedSize,i.filesTotalSize),i.filesTotalSize))},u.open("POST",o,!0);var n="---------"+(0,r.irand)(1111111111,9999999999);u.setRequestHeader("Content-Type","multipart/form-data, boundary="+n);var l="--"+n+"\r\n";l+="Content-Disposition: form-data; name='"+i.file_name+"'; filename='"+t.name.replace(/[&<>"']/g,"")+"'\r\n",l+="Content-Type: application/octet-stream\r\n\r\n",l+=f.result+"\r\n",l+="--"+n+"--",u.sendAsBinary(l)},f.readAsBinaryString(t)}catch(e){try{console.error(e)}catch(e){}}}x.options[e].xhr=u}else x.getUploadOptions(e,t)},terminateUpload:function(e,t,o){try{var i=x.vars[e],a=x.options[e],r=(0,m.toQueryString)(i),s=a.filesQueue,l=!1,d=a.multi_progress?{ind:e,fileName:null==t?void 0:t.replace(/[&<>"']/g,"")}:e,u=t?e+"_"+t:e;for(var p in s)if(t==(s[p].fileName||s[p].name||"").replace(/[&<>"']/g,"")){s.splice(p,1),l=!0;break}o&&o.tt&&o.tt.destroy&&o.tt.destroy(),(0,n.re)("upload"+u+"_progress_wrap"),x.onUploadComplete(d,'{"error":"ERR_UPLOAD_TERMINATED: upload request was terminated"}'),a.useNewUploader?!l&&a.uploadCancelFn&&a.uploadCancelFn():(!l&&a.xhr&&a.xhr.abort(),!l&&a.chunkedUpload&&a.chunkedUpload.abort());var c=this.uploadUrls[e]+(this.uploadUrls[e].match(/\?/)?"&":"?")+r;l||(s.length>0?x.uploadFile(e,s.pop(),c):(x.startNextQueue(e),x.onUploadCompleteAll(d,"")))}catch(e){try{console.error(e)}catch(e){}}},terminateAllUploads:function(){this.checked&&(0,r.each)(this.checked,(e=>{if(e=+e,x.isSomethingUploading(e)){var t=x.options[e];if(t){var o="";t.filesQueue&&t.filesQueue.length&&(t.filesQueue=[]),t.xhr&&4!==t.xhr.readyState&&0!==t.xhr.readyState&&(o=t.file_name),t.chunked&&t.chunkedUpload&&t.chunkedUpload.activeRequests.length&&(o=t.chunkedUpload.fileName,this.terminateUpload(e,o)),o&&this.terminateUpload(e,o)}}}))},startNextQueue:function(e){if(void 0===cur.multiProgressIndex&&setTimeout((function(){delete cur.fileApiUploadStarted}),1e3),e==cur.multiProgressIndex)if(this.options[e].multi_progress&&cur.nextQueues&&cur.nextQueues.length){var t=cur.nextQueues[0],o=x.options[t].filesQueue;for(cur.nextQueues.splice(0,1);0==o.length&&cur.nextQueues.length>0;)t=cur.nextQueues[0],cur.nextQueues.splice(0,1),o=x.options[t].filesQueue;if(o.length>0){var n=x.vars[t],i=(0,m.toQueryString)(n),a=x.uploadUrls[t]+(x.uploadUrls[t].match(/\?/)?"&":"?")+i;x.uploadFile(t,o.pop(),a),cur.multiProgressIndex=t}else delete cur.multiProgressIndex,setTimeout((function(){delete cur.fileApiUploadStarted}),1e3)}else delete cur.multiProgressIndex,setTimeout((function(){delete cur.fileApiUploadStarted}),1e3)},isFileDrag:function(e){if(!e||e.target&&("IMG"==e.target.tagName||"A"==e.target.tagName))return!1;if(!e.dataTransfer.types)return!0;for(var t=0;t<e.dataTransfer.types.length;t++)if("Files"==e.dataTransfer.types[t])return!0;return!1},dragEnter:function(e,t){cur.uploadDragStarted&&1!=cur.uploadDragStarted||(cur.uploadDragStarted=x.isFileDrag(t)?2:1),1!=cur.uploadDragStarted&&x.dropbox[e]?(setTimeout((function(){clearTimeout(x.dragTimer[e]),delete x.dragTimer[e]}),0),x.options[e].onDragEnter&&x.options[e].onDragEnter(t),(0,n.show)(x.dropbox[e]),(0,i.cancelEvent)(t)):(0,i.cancelEvent)(t)},dragOut:function(e,t){if(1!=cur.uploadDragStarted&&x.dropbox[e]){x.dragTimer[e]&&(clearTimeout(x.dragTimer[e]),delete x.dragTimer[e]);var o=function(){var t=x.options[e],o=x.dropbox[e];t.visibleDropbox||(0,n.hide)(o),t.onDragOut&&t.onDragOut(),(0,n.removeClass)(o,"dropbox_over")};!t.clientX&&!t.clientY?o():x.dragTimer[e]=setTimeout(o,100),(0,i.cancelEvent)(t)}else(0,i.cancelEvent)(t)},dragOver:function(e,t){if(1!=cur.uploadDragStarted&&x.dropbox[e]){var o=x.insideDropbox(e,t);t.dataTransfer&&"copy"!==t.dataTransfer.dropEffect&&(t.dataTransfer.dropEffect=o?"copy":"none"),(0,n.toggleClass)(x.dropbox[e],"dropbox_over",o),(0,i.cancelEvent)(t)}else(0,i.cancelEvent)(t)},drop:function(e){return(0,r.each)(x.dropbox,(function(t,o){o&&(x.insideDropbox(t,e)&&x.onFileApiSend(t,e.dataTransfer.files),x.options[t].visibleDropbox||(0,n.hide)(o),x.options[t].onDrop&&x.options[t].onDrop(),(0,n.removeClass)(o,"dropbox_over"))})),delete cur.uploadDragStarted,(0,i.cancelEvent)(e),!1},insideDropbox:function(e,t){for(var o=t.target;o.parentNode;){if(o==x.dropbox[e])return!0;o=o.parentNode}return!1},isSomethingUploading:function(e){var t=x.options[e];return!!t&&(!(!t.filesQueue||!t.filesQueue.length)||(!(!t.xhr||4===t.xhr.readyState||0===t.xhr.readyState)||(!(!t.uploadOptionsXhr||4===t.uploadOptionsXhr.readyState||0===t.uploadOptionsXhr.readyState)||!!(t.chunked&&t.chunkedUpload&&t.chunkedUpload.activeRequests.length))))},flashCallbacks:function(){return{onUploadStart:x.onUploadStart,onUploadProgress:x.onUploadProgress,onUploadSuccess:x.onUploadComplete,onUploadComplete:x.onUploadCompleteAll,onUploadError:x.onUploadError,onDebug:x.onDebug,onMouseDown:x.buttonDown,onMouseUp:x.buttonUp,onMouseOver:x.buttonOver,onMouseOut:x.buttonOut,onSelectClick:x.onSelectClick}},sendUploadStat:function(e,t){var o=x.options[e],n=x.vars[e];if(!o.signed&&o.error_hash){var i=(0,s.extend)({act:"stat",mid:n.mid,oid:n.oid,gid:n.gid,aid:n.aid,server:o.server,error:o.error,hash:o.error_hash},t);window.ajax.post("upload_fails.php",i)}}}},306908:(e,t,o)=>{"use strict";o.d(t,{VIDEO_UPLOAD_EXTS:()=>n,VIDEO_UPLOAD_MAX_FILE_SIZE_IN_GB:()=>i,VIDEO_UPLOAD_CHUNK_SIZE:()=>a,VIDEO_UPLOAD_FILE_THREAD_NUMBER:()=>r,VIDEO_UPLOAD_CHUNK_MAX_RETRY_NUMBER:()=>s});o(751876);var n="avi mp4 3gp mpeg mov flv f4v wmv mkv webm vob rm rmvb m4v mpg ogv ts m2ts mts mxf torrent".split(" "),i=5,a=4194304,r=4,s=10},535666:function(e,t,o){!function(t){"use strict";var o,n=Object.prototype,i=n.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag",d=t.regeneratorRuntime;if(d)e.exports=d;else{(d=t.regeneratorRuntime=e.exports).wrap=_;var u="suspendedStart",p="suspendedYield",c="executing",h="completed",f={},g={};g[r]=function(){return this};var m=Object.getPrototypeOf,v=m&&m(m(E([])));v&&v!==n&&i.call(v,r)&&(g=v);var b=S.prototype=k.prototype=Object.create(g);U.prototype=b.constructor=S,S.constructor=U,S[l]=U.displayName="GeneratorFunction",d.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===U||"GeneratorFunction"===(t.displayName||t.name))},d.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,l in e||(e[l]="GeneratorFunction")),e.prototype=Object.create(b),e},d.awrap=function(e){return{__await:e}},w(C.prototype),C.prototype[s]=function(){return this},d.AsyncIterator=C,d.async=function(e,t,o,n){var i=new C(_(e,t,o,n));return d.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(b),b[l]="Generator",b[r]=function(){return this},b.toString=function(){return"[object Generator]"},d.keys=function(e){var t=[];for(var o in e)t.push(o);return t.reverse(),function o(){for(;t.length;){var n=t.pop();if(n in e)return o.value=n,o.done=!1,o}return o.done=!0,o}},d.values=E,F.prototype={constructor:F,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=o)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,i){return s.type="throw",s.arg=e,t.next=n,i&&(t.method="next",t.arg=o),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],s=r.completion;if("root"===r.tryLoc)return n("end");if(r.tryLoc<=this.prev){var l=i.call(r,"catchLoc"),d=i.call(r,"finallyLoc");if(l&&d){if(this.prev<r.catchLoc)return n(r.catchLoc,!0);if(this.prev<r.finallyLoc)return n(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return n(r.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return n(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var n=this.tryEntries[o];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var r=a?a.completion:{};return r.type=e,r.arg=t,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(r)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.finallyLoc===e)return this.complete(o.completion,o.afterLoc),T(o),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc===e){var n=o.completion;if("throw"===n.type){var i=n.arg;T(o)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:E(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=o),f}}}function _(e,t,o,n){var i=t&&t.prototype instanceof k?t:k,a=Object.create(i.prototype),r=new F(n||[]);return a._invoke=function(e,t,o){var n=u;return function(i,a){if(n===c)throw new Error("Generator is already running");if(n===h){if("throw"===i)throw a;return P()}for(o.method=i,o.arg=a;;){var r=o.delegate;if(r){var s=x(r,o);if(s){if(s===f)continue;return s}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(n===u)throw n=h,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);n=c;var l=y(e,t,o);if("normal"===l.type){if(n=o.done?h:p,l.arg===f)continue;return{value:l.arg,done:o.done}}"throw"===l.type&&(n=h,o.method="throw",o.arg=l.arg)}}}(e,o,r),a}function y(e,t,o){try{return{type:"normal",arg:e.call(t,o)}}catch(e){return{type:"throw",arg:e}}}function k(){}function U(){}function S(){}function w(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function C(e){function o(t,n,a,r){var s=y(e[t],e,n);if("throw"!==s.type){var l=s.arg,d=l.value;return d&&"object"==typeof d&&i.call(d,"__await")?Promise.resolve(d.__await).then((function(e){o("next",e,a,r)}),(function(e){o("throw",e,a,r)})):Promise.resolve(d).then((function(e){l.value=e,a(l)}),r)}r(s.arg)}var n;"object"==typeof t.process&&t.process.domain&&(o=t.process.domain.bind(o)),this._invoke=function(e,t){function i(){return new Promise((function(n,i){o(e,t,n,i)}))}return n=n?n.then(i,i):i()}}function x(e,t){var n=e.iterator[t.method];if(n===o){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=o,x(e,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var i=y(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,f;var a=i.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=o),t.delegate=null,f):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function F(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function E(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=o,t.done=!0,t};return a.next=a}}return{next:P}}function P(){return{value:o,done:!0}}}("object"==typeof o.g?o.g:"object"==typeof window?window:"object"==typeof self?self:this)}}]);try{stManager.done("dist/db5e7763f24e9d1919decb2dcba4950b.71fa7cb8a273d124cdb0.js")}catch(e){}